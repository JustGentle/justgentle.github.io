<!DOCTYPE html>
<html>
    <head>
        <title>冬城博物奇珍簿</title>
        <meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0 user-scalable=yes" />
        <style type="text/css">
            body {
                line-height: 1.2;
                font-size: 14px;
            }
            .data {
                display: flex;
                border: 5px double #ddd;
            }
            .area {
                flex: 1;
                display: flex;
                flex-direction: column;
                background: black;
                color: white;
                padding: 20px;
                gap: 10px;
            }
            .area-switch {
                display: flex;
            }
            .area-prev, .area-next {
                flex: none;
                border: 1px solid white;
                border-radius: 50%;
                width: 1.2em;
                height: 1.2em;
                text-align: center;
                cursor: pointer;
            }
            .area-name {
                flex: 1;
                text-align: center;
            }
            .area-info {
                font-weight: bold;
            }
            .area-level {
                text-align: center;
                font-size: large;
                font-weight: bold;
                color: gold;
            }
            .area-values {
                display: flex;
                flex-direction: column;
                gap: 5px;
            }
            .area-value {
                display: flex;
                flex-direction: column;
            }
            .area-value-text {
                display: flex;
            }
            .area-value-name {
                flex: 1;
            }
            .area-value-sum.failed {
                color: red;
            }
            .area-value-sum.success {
                color: gold;
            }
            .area-value-process {
                position: relative;
                background-color: #ddd;
                height: .5em;
            }
            .area-process-sum {
                position: absolute;
                left: 0;
                top: 0;
                height: 100%;
                width: calc(attr(data-value) / 500 * 100%);
            }
            .area-process-sum.failed {
                background-color: red;
            }
            .area-process-sum.success {
                background-color: gold;
            }
            .area-process-max {
                position: absolute;
                left: 0;
                top: 0;
                height: 100%;
                width: calc(attr(data-value) / 500 * 100%);
                border-right: 2px solid white;
            }
            .area-emps {
                align-self: center;
                display: flex;
                gap: 10px;
            }
            .area-emp {
                border: 1px solid white;
                width: 50px;
                height: 60px;
                text-align: center;
            }
            .content {
                flex: 2;
                display: flex;
                flex-direction: column;
                padding: 10px;
            }
            .emps {
                flex: 1;
                display: flex;
                flex-wrap: wrap;
                align-items: start;
                gap: 10px;
                overflow-y: auto;
            }
            .emp {
                display: flex;
                flex-direction: column;
                background-color: #ddd;
                border-radius: 2px;
                padding: 5px;
                width: 12em;
            }
            .emp-values {
                background-color: white;
                color: black;
                display: flex;
                flex-direction: column;
                padding: 10px;
                gap: 5px;
            }
            .emp-value {
                display: flex;
                align-items: center;
                gap: 5px;
            }
            .emp-value-text {
                flex: none;
            }
            .emp-value-process {
                flex: 1;
                position: relative;
                background-color: #ddd;
                height: .5em;
            }
            .emp-value-sum {
                position: absolute;
                left: 0;
                top: 0;
                background-color: black;
                height: 100%;
                width: calc(68 / 100 * 100%);
            }
            .emp-name {
                background-color: black;
                color: white;
                text-align: center;
            }
            .btns {
                flex: none;
                display: flex;
                justify-content: end;
                padding-top: 10px;
                gap: 10px;
            }
            .btn {
                cursor: pointer;
                min-width: 8em;
                height: 2em;
                line-height: 2em;
                border-radius: 1em;
                border: 1px solid #ddd;
                text-align: center;
            }
            .btn.primary {
                background-color: gold;
            }

            .result {
                display: flex;
                flex-wrap: wrap;
                padding: 10px;
                gap: 10px;
            }
            .result .area {
                width: 15em;
                flex: none;
            }
        </style>
        <script type="text/javascript">
            const ui = {};
            const areas = {};
            const defs = {};
            const emps = {};
            const levels = ['C','B','A','S'];
            function init() {
                mydata();
                ui.data = document.querySelector('.data');
                ui.result = document.querySelector('.result');
                //ui.data.innerText = JSON.stringify(areas,null,2) + JSON.stringify(defs,null,2) + JSON.stringify(emps,null,2);
            };
            function calc() {
                ui.result.innerHtml = '';
                const values = {};
                const results = {};
                for (const area in areas) {
                    values[area] = {};
                    results[area] = {};
                    for (const emp1 in emps) {
                        for (const emp2 in emps) {
                            if (emp1 === emp2) continue;
                            for (const emp3 in emps) {
                                if (emp1 === emp3 || emp2 === emp3) continue;
                                values[area][`${emp1}+${emp2}+${emp3}`] = [
                                    emps[emp1][0]+emps[emp2][0]+emps[emp3][0],
                                    emps[emp1][1]+emps[emp2][1]+emps[emp3][1],
                                    emps[emp1][2]+emps[emp2][2]+emps[emp3][2]
                                ];
                                results[area][`${emp1}+${emp2}+${emp3}`] = [
                                    defs[area][0] + emps[emp1][0] + emps[emp2][0] + emps[emp3][0] - areas[area][0],
                                    defs[area][1] + emps[emp1][1] + emps[emp2][1] + emps[emp3][1] - areas[area][1],
                                    defs[area][2] + emps[emp1][2] + emps[emp2][2] + emps[emp3][2] - areas[area][2]
                                ];
                            }
                        }
                    }
                }
                for (const area in areas) {
                    const keys = Object.keys(results[area]).sort((a,b) => {
                        const suma = results[area][a].reduce((sum, value) => value < 0 ? sum : sum + 1, 0);
                        const sumb = results[area][b].reduce((sum, value) => value < 0 ? sum : sum + 1, 0);
                        return sumb - suma;
                    });
                    const sorted = {};
                    for (const key of keys) {
                        sorted[key] = results[area][key];
                        const elem = document.createElement('div');
                        ui.result.appendChild(elem);
                        elem.outerHTML = getArea(area, key, sorted[key]);
                    }
                    results[area] = sorted;
                }
                
            };
            function getArea(area, names, result) {
                let namearr = names.split('+');
                let level = result.reduce((sum, value) => value < 0 ? sum : sum + 1, 0);
                let html = `<div class="area" data-name="${area}">
                    <div class="area-switch">
                        <div class="area-name">${area}</div>
                    </div>
                    <div class="area-level">${levels[level]}</div>
                    <div class="area-values">
                        <div class="area-value">
                            <div class="area-value-text">
                                <div class="area-value-name">游览时长</div>
                                <div class="area-value-sum ${result[0]>=areas[area][0]?'success':'failed'}">${result[0]}</div>
                                <div class="area-value-split">/</div>
                                <div class="area-value-max">${areas[area][0]}</div>
                            </div>
                            <div class="area-value-process">
                                <div class="area-process-sum" data-value="${result[0]}"></div>
                                <div class="area-process-max" data-value="${areas[area][0]}"></div>
                            </div>
                        </div>
                        <div class="area-value">
                            <div class="area-value-text">
                                <div class="area-value-name">科普价值</div>
                                <div class="area-value-sum${result[1]>=areas[area][1]?'success':'failed'}">${result[1]}</div>
                                <div class="area-value-split">/</div>
                                <div class="area-value-max">${areas[area][1]}</div>
                            </div>
                            <div class="area-value-process">
                                <div class="area-process-sum" data-value="${result[1]}"></div>
                                <div class="area-process-max" data-value="${areas[area][1]}"></div>
                            </div>
                        </div>
                        <div class="area-value">
                            <div class="area-value-text">
                                <div class="area-value-name">吸引人流</div>
                                <div class="area-value-sum${result[2]>=areas[area][2]?'success':'failed'}">${result[2]}</div>
                                <div class="area-value-split">/</div>
                                <div class="area-value-max">${areas[area][2]}</div>
                            </div>
                            <div class="area-value-process">
                                <div class="area-process-sum" data-value="${result[2]}"></div>
                                <div class="area-process-max" data-value="${areas[area][2]}"></div>
                            </div>
                        </div>
                        <div class="area-emps">
                            <div class="area-emp">${namearr[0]}</div>
                            <div class="area-emp">${namearr[1]}</div>
                            <div class="area-emp">${namearr[2]}</div>
                        </div>
                    </div>
                </div>`;
                return html;
            }
            function mydata() {
                Object.assign(areas, {
                    "综合区-外": [240,195,235],
                    "综合区-内": [205,245,150]
                });
                Object.assign(defs, {
                    "综合区-外": [70,70,70],
                    "综合区-内": [90,90,90]
                });
                Object.assign(emps, {
                    "希露瓦": [68,57,10],
                    "匹克": [44,54,10],
                    "尤利安": [52,20,36],
                    "吉尔伯特": [36,40,20],
                    "莉拉": [52,14,30],
                    "费斯曼": [50,29,17],
                    "佩拉": [30,30,30],
                    "亚诺": [40,8,30],
                    "伊蕾恩": [26,26,26],
                    "希露瓦的狂热粉丝": [20,44,14]
                });
            };
        </script>
    </head>
    <body onload="init()">
        <div class="data">
            <div class="area">
                <div class="area-switch">
                    <div class="area-prev">&lt;</div>
                    <div class="area-name">综合区-外</div>
                    <div class="area-next">&gt;</div>
                </div>
                <div class="area-info">可获取振兴值 2000</div>
                <div class="area-values">
                    <div class="area-value">
                        <div class="area-value-text">
                            <div class="area-value-name">游览时长</div>
                            <div class="area-value-sum less">70</div>
                            <div class="area-value-split">/</div>
                            <div class="area-value-max">240</div>
                        </div>
                        <div class="area-value-process">
                            <div class="area-process-sum" data-value="70"></div>
                            <div class="area-process-max" data-max="240"></div>
                        </div>
                    </div>
                    <div class="area-value">
                        <div class="area-value-text">
                            <div class="area-value-name">科普价值</div>
                            <div class="area-value-sum less"></div>
                            <div class="area-value-split">/</div>
                            <div class="area-value-max"></div>
                        </div>
                        <div class="area-value-process">
                            <div class="area-process-sum"></div>
                            <div class="area-process-max"></div>
                        </div>
                    </div>
                    <div class="area-value">
                        <div class="area-value-text">
                            <div class="area-value-name">吸引人流</div>
                            <div class="area-value-sum less"></div>
                            <div class="area-value-split">/</div>
                            <div class="area-value-max"></div>
                        </div>
                        <div class="area-value-process">
                            <div class="area-process-sum"></div>
                            <div class="area-process-max"></div>
                        </div>
                    </div>
                    <div class="area-emps">
                        <div class="area-emp"></div>
                        <div class="area-emp"></div>
                        <div class="area-emp"></div>
                    </div>
                </div>
            </div>
            <div class="content">
                <div class="emps">
                    <div class="emp">
                        <div class="emp-values">
                            <div class="emp-value">
                                <div class="emp-value-text">68</div>
                                <div class="emp-value-process">
                                    <div class="emp-value-sum"></div>
                                </div>
                            </div>
                            <div class="emp-value">
                                <div class="emp-value-text">57</div>
                                <div class="emp-value-process">
                                    <div class="emp-value-sum"></div>
                                </div>
                            </div>
                            <div class="emp-value">
                                <div class="emp-value-text">10</div>
                                <div class="emp-value-process">
                                    <div class="emp-value-sum"></div>
                                </div>
                            </div>
                        </div>
                        <div class="emp-name">希露瓦</div>
                    </div>
                </div>
                <div class="btns">
                    <!--<div class="btn default" onclick="clear()">重置</div>-->
                    <div class="btn primary" onclick="calc()">计算</div>
                </div>
            </div>
        </div>
        <div class="result">
            <!--
            <div class="area">
                <div class="area-switch">
                    <div class="area-name">综合区-外</div>
                </div>
                <div class="area-level">C</div>
                <div class="area-values">
                    <div class="area-value">
                        <div class="area-value-text">
                            <div class="area-value-name">游览时长</div>
                            <div class="area-value-def">70</div>
                            <div class="area-value-split">/</div>
                            <div class="area-value-sum">70</div>
                            <div class="area-value-split">/</div>
                            <div class="area-value-max">240</div>
                        </div>
                        <div class="area-value-process">
                            <div class="area-process-sum"></div>
                            <div class="area-process-max"></div>
                        </div>
                    </div>
                    <div class="area-value">
                        <div class="area-value-text">
                            <div class="area-value-name">科普价值</div>
                            <div class="area-value-def"></div>
                            <div class="area-value-split">/</div>
                            <div class="area-value-sum"></div>
                            <div class="area-value-split">/</div>
                            <div class="area-value-max"></div>
                        </div>
                        <div class="area-value-process">
                            <div class="area-process-sum"></div>
                            <div class="area-process-max"></div>
                        </div>
                    </div>
                    <div class="area-value">
                        <div class="area-value-text">
                            <div class="area-value-name">吸引人流</div>
                            <div class="area-value-def"></div>
                            <div class="area-value-split">/</div>
                            <div class="area-value-sum"></div>
                            <div class="area-value-split">/</div>
                            <div class="area-value-max"></div>
                        </div>
                        <div class="area-value-process">
                            <div class="area-process-sum"></div>
                            <div class="area-process-max"></div>
                        </div>
                    </div>
                    <div class="area-emps">
                        <div class="area-emp">希露瓦</div>
                        <div class="area-emp">希露瓦的狂热粉丝</div>
                        <div class="area-emp">吉尔伯特</div>
                    </div>
                </div>
            </div>
            -->
        </div>
    </body>
</html>